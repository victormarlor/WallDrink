import { useNavigate, useLocation } from "react-router-dom";
import { useEffect, useState } from "react";
import "./NavBar.css";
import logo from "../assets/IsologoWallDrink.png";

const NavBar = ({ isAuthenticated, userRole }) => {
  const navigate = useNavigate();
  const location = useLocation();
  const currentPath = location.pathname;
  const [scrolled, setScrolled] = useState(false);

const lastPanel = localStorage.getItem("lastPanel");
const isSeller = userRole === "seller" && lastPanel === "seller";

  const handleProtectedClick = (path) => {
    if (isAuthenticated) {
      navigate(path);
    } else {
      navigate("/login");
    }
  };

  useEffect(() => {
    const handleScroll = () => {
      setScrolled(window.scrollY > 0);
    };
    window.addEventListener("scroll", handleScroll);
    return () => window.removeEventListener("scroll", handleScroll);
  }, []);

  const isDarkNavbar = ["/mi-cuenta", "/store", "/productos"].includes(currentPath);

  if (isSeller) {
    // üåü NAVBAR PARA VENDEDORES
    return (
      <nav className={`navbar ${scrolled ? "scrolled" : ""} ${isDarkNavbar ? "navbar-dark" : ""}`}>
        <div className="navbar-wrapper">
          {/* Logo */}
          <img
            src={logo}
            alt="Logo"
            className="navbar-logo"
            onClick={() => navigate("/")}
          />

          {/* Icono casa + pedidos */}
          <div className="navbar-search">
            <svg
              onClick={() => navigate("/productos")}
              className={`navbar-icon ${currentPath === "/productos" ? "active-icon" : ""}`}
              width="24"
              height="24"
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
            </svg>
            <div className="navbar-divider" />
            <button
              onClick={() => handleProtectedClick("/pedidos")}
              className={`navbar-link ${currentPath === "/pedidos" ? "active-text" : ""}`}
            >
              Pedidos
            </button>
          </div>

          {/* üë§ MI CUENTA */}
          <div className="navbar-icons" onClick={() => handleProtectedClick("/mi-cuenta")}>
            {currentPath === "/mi-cuenta" ? (
                                  <svg width="25" height="28" viewBox="0 0 25 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.0083 7.47917C17.0083 6.36374 16.5552 5.29399 15.7487 4.50527C14.9421 3.71654 13.8483 3.27344 12.7077 3.27344C11.5671 3.27344 10.4732 3.71654 9.6667 4.50527C8.86018 5.29399 8.40709 6.36374 8.40709 7.47917C8.40709 8.59459 8.86018 9.66434 9.6667 10.4531C10.4732 11.2418 11.5671 11.6849 12.7077 11.6849C13.8483 11.6849 14.9421 11.2418 15.7487 10.4531C16.5552 9.66434 17.0083 8.59459 17.0083 7.47917ZM5.82673 7.47917C5.82673 5.69448 6.55169 3.98289 7.84211 2.72093C9.13254 1.45896 10.8827 0.75 12.7077 0.75C14.5326 0.75 16.2828 1.45896 17.5733 2.72093C18.8637 3.98289 19.5886 5.69448 19.5886 7.47917C19.5886 9.26385 18.8637 10.9754 17.5733 12.2374C16.2828 13.4994 14.5326 14.2083 12.7077 14.2083C10.8827 14.2083 9.13254 13.4994 7.84211 12.2374C6.55169 10.9754 5.82673 9.26385 5.82673 7.47917ZM3.31626 25.1432H22.1045C21.626 21.8154 18.7016 19.2552 15.1698 19.2552H10.2563C6.72448 19.2552 3.80007 21.8154 3.32163 25.1432H3.31626ZM0.666016 26.1053C0.666016 20.927 4.95586 16.7318 10.251 16.7318H15.1644C20.4595 16.7318 24.7493 20.927 24.7493 26.1053C24.7493 26.9675 24.0344 27.6667 23.1528 27.6667H2.26261C1.38099 27.6667 0.666016 26.9675 0.666016 26.1053Z" fill="#E6FA4D"/>
                    <path d="M3.32163 25.1432H22.1045C21.626 21.8154 18.7016 19.2552 15.1698 19.2552H10.2563C6.72448 19.2552 3.80007 21.8154 3.32163 25.1432Z" fill="#E6FA4D"/>
                    <path d="M17.0083 7.47917C17.0083 6.36374 16.5552 5.29399 15.7487 4.50527C14.9421 3.71654 13.8483 3.27344 12.7077 3.27344C11.5671 3.27344 10.4732 3.71654 9.6667 4.50527C8.86018 5.29399 8.40709 6.36374 8.40709 7.47917C8.40709 8.59459 8.86018 9.66434 9.6667 10.4531C10.4732 11.2418 11.5671 11.6849 12.7077 11.6849C13.8483 11.6849 14.9421 11.2418 15.7487 10.4531C16.5552 9.66434 17.0083 8.59459 17.0083 7.47917Z" fill="#E6FA4D"/>
                    </svg>

              ) : (
                    <svg width="25" height="28" viewBox="0 0 25 28" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.0093 7.47917C17.0093 6.36374 16.5562 5.29399 15.7496 4.50527C14.9431 3.71654 13.8492 3.27344 12.7087 3.27344C11.5681 3.27344 10.4742 3.71654 9.66768 4.50527C8.86116 5.29399 8.40806 6.36374 8.40806 7.47917C8.40806 8.5946 8.86116 9.66434 9.66768 10.4531C10.4742 11.2418 11.5681 11.6849 12.7087 11.6849C13.8492 11.6849 14.9431 11.2418 15.7496 10.4531C16.5562 9.66434 17.0093 8.5946 17.0093 7.47917ZM5.82771 7.47917C5.82771 5.69448 6.55266 3.98289 7.84309 2.72093C9.13352 1.45896 10.8837 0.75 12.7087 0.75C14.5336 0.75 16.2838 1.45896 17.5742 2.72093C18.8647 3.98289 19.5896 5.69448 19.5896 7.47917C19.5896 9.26385 18.8647 10.9754 17.5742 12.2374C16.2838 13.4994 14.5336 14.2083 12.7087 14.2083C10.8837 14.2083 9.13352 13.4994 7.84309 12.2374C6.55266 10.9754 5.82771 9.26385 5.82771 7.47917ZM3.31723 25.1432H22.1055C21.627 21.8154 18.7026 19.2552 15.1707 19.2552H10.2573C6.72546 19.2552 3.80105 21.8154 3.32261 25.1432H3.31723ZM0.666992 26.1053C0.666992 20.927 4.95684 16.7318 10.2519 16.7318H15.1654C20.4605 16.7318 24.7503 20.927 24.7503 26.1053C24.7503 26.9675 24.0354 27.6667 23.1537 27.6667H2.26359C1.38197 27.6667 0.666992 26.9675 0.666992 26.1053Z"/>
                    </svg>
              )}
          </div>
        </div>
      </nav>
    );
  }

  // üåü NAVBAR PARA COMPRADORES
  return (
    <nav className={`navbar ${scrolled ? "scrolled" : ""} ${isDarkNavbar ? "navbar-dark" : ""}`}>
      <div className="navbar-wrapper">
        <img
          src={logo}
          alt="Logo"
          className="navbar-logo"
          onClick={() => navigate("/")}
        />

        <div className="navbar-search">
          <svg
            onClick={() => navigate("/buscar")}
            className={`navbar-icon ${location.pathname === "/" ? "active-icon" : ""}`}
            width="20"
            height="20"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
                d="M15.9383 8.21762C15.9383 9.92069 15.3853 11.4939 14.4538 12.7703L19.1521 17.4713C19.616 17.9351 19.616 18.6884 19.1521 19.1522C18.6882 19.6159 17.9348 19.6159 17.4709 19.1522L12.7727 14.4511C11.496 15.3861 9.92253 15.9352 8.21913 15.9352C3.95505 15.9352 0.5 12.4809 0.5 8.21762C0.5 3.95438 3.95505 0.5 8.21913 0.5C12.4832 0.5 15.9383 3.95438 15.9383 8.21762ZM8.21913 13.5606C8.92091 13.5606 9.61583 13.4224 10.2642 13.1539C10.9126 12.8854 11.5017 12.4918 11.9979 11.9957C12.4941 11.4995 12.8878 10.9105 13.1563 10.2623C13.4249 9.61405 13.5631 8.91927 13.5631 8.21762C13.5631 7.51597 13.4249 6.82119 13.1563 6.17295C12.8878 5.52472 12.4941 4.93571 11.9979 4.43957C11.5017 3.94343 10.9126 3.54987 10.2642 3.28136C9.61583 3.01285 8.92091 2.87465 8.21913 2.87465C7.51734 2.87465 6.82243 3.01285 6.17406 3.28136C5.5257 3.54987 4.93658 3.94343 4.44034 4.43957C3.9441 4.93571 3.55047 5.52472 3.2819 6.17295C3.01334 6.82119 2.87512 7.51597 2.87512 8.21762C2.87512 8.91927 3.01334 9.61405 3.2819 10.2623C3.55047 10.9105 3.9441 11.4995 4.44034 11.9957C4.93658 12.4918 5.5257 12.8854 6.17406 13.1539C6.82243 13.4224 7.51734 13.5606 8.21913 13.5606Z"
            /></svg>
          <div className="navbar-divider" />
            <button
              onClick={() => handleProtectedClick("/mis-pedidos")}
              className={`navbar-link ${location.pathname === "/mis-pedidos" ? "active-text" : ""}`}
            >
              Mis pedidos
            </button>
        </div>

        <div className="navbar-icons">
          {/* ‚ù§Ô∏è FAVORITOS */}
          <div onClick={() => handleProtectedClick("/favoritos")}>
            {currentPath === "/favoritos" ? (
                    <svg width="31" height="25" viewBox="0 0 31 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13.5372 23.5944L13.3919 23.4678L3.21187 14.507C1.42803 12.9373 0.416992 10.7343 0.416992 8.42664V8.24489C0.416992 4.36757 3.32227 1.04101 7.34316 0.314015C9.63252 -0.104559 11.9742 0.396628 13.8394 1.64133C14.3623 1.99382 14.8504 2.40138 15.292 2.86952C15.536 2.60516 15.7975 2.36282 16.0764 2.13701C16.2914 1.96077 16.5122 1.79555 16.7446 1.64133C18.6098 0.396628 20.9515 -0.104559 23.2408 0.308507C27.2617 1.0355 30.167 4.36757 30.167 8.24489V8.42664C30.167 10.7343 29.156 12.9373 27.3721 14.507L17.192 23.4678L17.0468 23.5944C16.5703 24.013 15.9428 24.2498 15.292 24.2498C14.6412 24.2498 14.0137 24.0185 13.5372 23.5944ZM14.31 5.79403C14.2868 5.77751 14.2693 5.75548 14.2519 5.73345L13.2176 4.63194L13.2118 4.62643C11.8696 3.19997 9.8417 2.55008 7.86611 2.90807C5.1584 3.39824 3.20605 5.63431 3.20605 8.24489V8.42664C3.20605 9.99629 3.89751 11.4999 5.11191 12.5683L15.292 21.5291L25.4721 12.5683C26.6865 11.4999 27.3779 9.99629 27.3779 8.42664V8.24489C27.3779 5.63982 25.4256 3.39824 22.7237 2.90807C20.7481 2.55008 18.7144 3.20548 17.378 4.62643C17.378 4.62643 17.378 4.62643 17.3722 4.63194C17.3664 4.63744 17.3722 4.63194 17.3664 4.63744L16.3321 5.73895C16.3146 5.76098 16.2914 5.77751 16.274 5.79954C16.0125 6.04738 15.6581 6.18507 15.292 6.18507C14.9259 6.18507 14.5715 6.04738 14.31 5.79954V5.79403Z" fill="#E6FA4D"/>
                    <path d="M14.31 5.79403C14.2868 5.77751 14.2693 5.75548 14.2519 5.73345L13.2176 4.63194L13.2118 4.62643C11.8696 3.19997 9.8417 2.55008 7.86611 2.90807C5.1584 3.39824 3.20605 5.63431 3.20605 8.24489V8.42664C3.20605 9.99629 3.89751 11.4999 5.11191 12.5683L15.292 21.5291L25.4721 12.5683C26.6865 11.4999 27.3779 9.99629 27.3779 8.42664V8.24489C27.3779 5.63982 25.4256 3.39824 22.7237 2.90807C20.7481 2.55008 18.7144 3.20548 17.378 4.62643L17.3722 4.63194L17.3664 4.63744L16.3321 5.73895C16.3146 5.76098 16.2914 5.77751 16.274 5.79954C16.0125 6.04738 15.6581 6.18507 15.292 6.18507C14.9259 6.18507 14.5715 6.04738 14.31 5.79954V5.79403Z" fill="#E6FA4D"/>
                    </svg>

              ) : (
                    <svg width="31" height="25" viewBox="0 0 31 25" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13.5372 23.5944L13.3919 23.4678L3.21187 14.507C1.42803 12.9373 0.416992 10.7343 0.416992 8.42664V8.24489C0.416992 4.36757 3.32227 1.04101 7.34316 0.314015C9.63252 -0.104559 11.9742 0.396628 13.8394 1.64133C14.3623 1.99382 14.8504 2.40138 15.292 2.86952C15.536 2.60516 15.7975 2.36282 16.0764 2.13701C16.2914 1.96077 16.5122 1.79555 16.7446 1.64133C18.6098 0.396628 20.9515 -0.104559 23.2408 0.308507C27.2617 1.0355 30.167 4.36757 30.167 8.24489V8.42664C30.167 10.7343 29.156 12.9373 27.3721 14.507L17.192 23.4678L17.0468 23.5944C16.5703 24.013 15.9428 24.2498 15.292 24.2498C14.6412 24.2498 14.0137 24.0185 13.5372 23.5944ZM14.31 5.79403C14.2868 5.77751 14.2693 5.75548 14.2519 5.73345L13.2176 4.63194L13.2118 4.62643C11.8696 3.19997 9.8417 2.55008 7.86611 2.90807C5.1584 3.39824 3.20605 5.63431 3.20605 8.24489V8.42664C3.20605 9.99629 3.89751 11.4999 5.11191 12.5683L15.292 21.5291L25.4721 12.5683C26.6865 11.4999 27.3779 9.99629 27.3779 8.42664V8.24489C27.3779 5.63982 25.4256 3.39824 22.7237 2.90807C20.7481 2.55008 18.7144 3.20548 17.378 4.62643C17.378 4.62643 17.378 4.62643 17.3722 4.63194C17.3664 4.63744 17.3722 4.63194 17.3664 4.63744L16.3321 5.73895C16.3146 5.76098 16.2914 5.77751 16.274 5.79954C16.0125 6.04738 15.6581 6.18507 15.292 6.18507C14.9259 6.18507 14.5715 6.04738 14.31 5.79954V5.79403Z" />
                    </svg>
            )}
          </div>

          {/* üõí CARRITO */}
          <div onClick={() => handleProtectedClick("/carrito")}>
            {currentPath === "/carrito" ? (
                    <svg width="24" height="28" viewBox="0 0 24 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.666016 7.46746H23.3327V22.7077C23.3293 25.4451 21.0932 27.6634 18.334 27.6667H5.66497C2.90548 27.6633 0.669381 25.4451 0.666016 22.708V7.46746ZM20.9691 9.81216H17.6956H15.3319H8.66667H6.30317H3.02962V22.7077C3.03161 24.1508 4.21032 25.32 5.66478 25.322H18.3337C19.7884 25.32 20.9671 24.1507 20.9691 22.7079V9.81216ZM17.6956 11.9926H15.3319V9.81216V6.4006C15.3319 4.57479 13.8399 3.09464 11.9993 3.09464C10.1587 3.09464 8.66667 4.57479 8.66667 6.4006V9.81216V11.9926H7.48492H6.30317V9.81216V6.4006C6.30317 3.27988 8.85346 0.75 11.9994 0.75C15.1454 0.75 17.6956 3.27987 17.6956 6.40065L17.6956 9.81216L17.6956 11.9926Z" fill="#E6FA4D"/>
                    <path d="M20.9691 9.81216H17.6956L17.6956 11.9926H15.3319V9.81216H8.66667V11.9926H7.48492H6.30317V9.81216H3.02962V22.7077C3.03161 24.1508 4.21032 25.32 5.66478 25.322H18.3337C19.7884 25.32 20.9671 24.1507 20.9691 22.7079V9.81216Z" fill="#E6FA4D"/>
                    </svg>
              ) : (
                    <svg width="24" height="28" viewBox="0 0 24 28" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.666992 7.46746H23.3337V22.7077C23.3303 25.4451 21.0942 27.6634 18.335 27.6667H5.66595C2.90646 27.6633 0.670357 25.4451 0.666992 22.708V22.7077V7.46746ZM20.9701 9.81216H3.0306V22.7077C3.03259 24.1508 4.21129 25.32 5.66576 25.322H18.3347C19.7894 25.32 20.9681 24.1507 20.9701 22.7079V22.7077V9.81216ZM17.6965 11.9926H15.3329V6.4006C15.3329 4.57479 13.8409 3.09464 12.0003 3.09464C10.1597 3.09464 8.66765 4.57479 8.66765 6.4006V11.9926H7.4859H6.30415V6.4006C6.30415 3.27988 8.85443 0.75 12.0004 0.75C15.1463 0.75 17.6966 3.27988 17.6966 6.40065L17.6965 11.9926Z"/>
                    </svg>
              )}
          </div>

          {/* üë§ MI CUENTA */}
          <div onClick={() => handleProtectedClick("/mi-cuenta")}>
            {currentPath === "/mi-cuenta" ? (
                                  <svg width="25" height="28" viewBox="0 0 25 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.0083 7.47917C17.0083 6.36374 16.5552 5.29399 15.7487 4.50527C14.9421 3.71654 13.8483 3.27344 12.7077 3.27344C11.5671 3.27344 10.4732 3.71654 9.6667 4.50527C8.86018 5.29399 8.40709 6.36374 8.40709 7.47917C8.40709 8.59459 8.86018 9.66434 9.6667 10.4531C10.4732 11.2418 11.5671 11.6849 12.7077 11.6849C13.8483 11.6849 14.9421 11.2418 15.7487 10.4531C16.5552 9.66434 17.0083 8.59459 17.0083 7.47917ZM5.82673 7.47917C5.82673 5.69448 6.55169 3.98289 7.84211 2.72093C9.13254 1.45896 10.8827 0.75 12.7077 0.75C14.5326 0.75 16.2828 1.45896 17.5733 2.72093C18.8637 3.98289 19.5886 5.69448 19.5886 7.47917C19.5886 9.26385 18.8637 10.9754 17.5733 12.2374C16.2828 13.4994 14.5326 14.2083 12.7077 14.2083C10.8827 14.2083 9.13254 13.4994 7.84211 12.2374C6.55169 10.9754 5.82673 9.26385 5.82673 7.47917ZM3.31626 25.1432H22.1045C21.626 21.8154 18.7016 19.2552 15.1698 19.2552H10.2563C6.72448 19.2552 3.80007 21.8154 3.32163 25.1432H3.31626ZM0.666016 26.1053C0.666016 20.927 4.95586 16.7318 10.251 16.7318H15.1644C20.4595 16.7318 24.7493 20.927 24.7493 26.1053C24.7493 26.9675 24.0344 27.6667 23.1528 27.6667H2.26261C1.38099 27.6667 0.666016 26.9675 0.666016 26.1053Z" fill="#E6FA4D"/>
                    <path d="M3.32163 25.1432H22.1045C21.626 21.8154 18.7016 19.2552 15.1698 19.2552H10.2563C6.72448 19.2552 3.80007 21.8154 3.32163 25.1432Z" fill="#E6FA4D"/>
                    <path d="M17.0083 7.47917C17.0083 6.36374 16.5552 5.29399 15.7487 4.50527C14.9421 3.71654 13.8483 3.27344 12.7077 3.27344C11.5671 3.27344 10.4732 3.71654 9.6667 4.50527C8.86018 5.29399 8.40709 6.36374 8.40709 7.47917C8.40709 8.59459 8.86018 9.66434 9.6667 10.4531C10.4732 11.2418 11.5671 11.6849 12.7077 11.6849C13.8483 11.6849 14.9421 11.2418 15.7487 10.4531C16.5552 9.66434 17.0083 8.59459 17.0083 7.47917Z" fill="#E6FA4D"/>
                    </svg>

              ) : (
                    <svg width="25" height="28" viewBox="0 0 25 28" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.0093 7.47917C17.0093 6.36374 16.5562 5.29399 15.7496 4.50527C14.9431 3.71654 13.8492 3.27344 12.7087 3.27344C11.5681 3.27344 10.4742 3.71654 9.66768 4.50527C8.86116 5.29399 8.40806 6.36374 8.40806 7.47917C8.40806 8.5946 8.86116 9.66434 9.66768 10.4531C10.4742 11.2418 11.5681 11.6849 12.7087 11.6849C13.8492 11.6849 14.9431 11.2418 15.7496 10.4531C16.5562 9.66434 17.0093 8.5946 17.0093 7.47917ZM5.82771 7.47917C5.82771 5.69448 6.55266 3.98289 7.84309 2.72093C9.13352 1.45896 10.8837 0.75 12.7087 0.75C14.5336 0.75 16.2838 1.45896 17.5742 2.72093C18.8647 3.98289 19.5896 5.69448 19.5896 7.47917C19.5896 9.26385 18.8647 10.9754 17.5742 12.2374C16.2838 13.4994 14.5336 14.2083 12.7087 14.2083C10.8837 14.2083 9.13352 13.4994 7.84309 12.2374C6.55266 10.9754 5.82771 9.26385 5.82771 7.47917ZM3.31723 25.1432H22.1055C21.627 21.8154 18.7026 19.2552 15.1707 19.2552H10.2573C6.72546 19.2552 3.80105 21.8154 3.32261 25.1432H3.31723ZM0.666992 26.1053C0.666992 20.927 4.95684 16.7318 10.2519 16.7318H15.1654C20.4605 16.7318 24.7503 20.927 24.7503 26.1053C24.7503 26.9675 24.0354 27.6667 23.1537 27.6667H2.26359C1.38197 27.6667 0.666992 26.9675 0.666992 26.1053Z"/>
                    </svg>
              )}
          </div>
        </div>
      </div>
    </nav>
  );
};

export default NavBar;
